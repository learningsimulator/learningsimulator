Lägg allt admin i admin.py som inte finns i repot (som config.py)

Hur kan en nyreggad användare få "There is an ongoing simulation"?

När is_done sätts till True, clear message1

SimulationTask.is_done måste sättas till false vid fel
(för att undvika "There is an ongoing simulation")

Se till att Sim-object tas bort (eller sätter is_done till True) vid db-problem samt vid t.ex. inloggning/utloggning, för
att undvika "There is an ongoing simulation"

Säkra upp koden mot alla db-problem.

Förstå de två PythonAnywhere db configs:
    app.config['SQLALCHEMY_POOL_RECYCLE'] = 280
    app.config['SQLALCHEMY_POOL_TIMEOUT'] = 10

Gör mplfigimg och export directories till configs, och inte under "static"

Använd app.config['X'] isf "import X from config"
( I __init__: app.config.from_pyfile('config.cfg') som i https://www.youtube.com/watch?v=0cySORIhkCg)

Use 
    if (!response.ok) {
        throw new Error('Network response was not ok');
    }
for all fetches

Safeguard code against export file being deleted from server between run and download

Add "Download" to the exported files, when checked that it works on PythonAnywhere.
(Man får "Not allowed to load local resource:" i Inspect > Konsol när man kör lokalt.)

try/except för get_sim_status så att simuleringen funkar trots db problem vid progress status.

Ta bort simulation (sätt is_donw till True) vid ALLA sorts fel så att inte  "There is an ongoing simulation" händer när det inte ska

Varför fortsätter /get_sim_status även efter man klickat "Cancel" i progress dlg? Kolla om det är så.

"Change password"-feature

How to generate password as admin?

Should it be "Name" or "User name" in user account?

Tabbed layout with current script on one tab and demo script on the other
(or "Demo scripts" like "My scripts")



Editor: Set font size, color, bgcolor, line height, "color scheme": (font color, bg color, comment color)
Editor: Search/Replace
Editor: Insert block (parameters, variables, phase) - inserts at cursor (or at the end)
Editor: Import demo script (replaces content of entire script window) - warn if nonempty

Snyggare inloggningsskärm /login

Logga in/ut uppe till höger - kanske med användarnamnet

Begränsa storlek på plot (width, height validate)

Begränsa längd på filnamn i export

Make Navbar nice (with Bg-color) "Home, My Scripts, Log out" 

Possibility for user to delete account- "This cannot be undone", "will delete all your scripts..."

start_at_1

Check that html element constraints (min, max values, string lengths, required, etc) match db
-1 < legend_{x,y} < 2 kanske?

"Script ... saved" flash (how to use on same page)
https://stackoverflow.com/questions/40949746/how-to-display-flashing-message-without-reloading-the-page-in-flask

Plot: "Download" button for mpl image plots (instead of having to right-click and save image as)

Plot: Subplot titles workaround
(https://stackoverflow.com/questions/51592730/how-to-add-title-to-each-subplot-in-plotly-js, 
https://codepen.io/mdnasirfardoush/pen/gjovjO?editors=1010)

Test accessibility bugs:
https://www.deque.com/codepen/?utm_source=codepen&utm_medium=sponsored&utm_campaign=202208_pen

favicon: see warning in console (used before DOM is loaded?)

A clickable question-mark icon for help on some settings, at least plotly/mpl.
(Include "This is the DEFAULT setting - it can be changed in each plot interactively
after the plot is created")

Freeze mpl4 (and maybe other stuff) to make them local.

Skriv ut versionsnummer någonstans (kanske även version av mpl3, plotly, etc.)

Uniform styling of buttons (hovering color, click color, etc.)

Move (all) inline styling to css

Hide db passwd, SECRET_KEY, etc.

Report problems - link to GH Issues, maybe landing page
Link to project page (somewhere, maybe landing page)

------------------------------------------------------------------------
X (DB-)Admin page (skall åtminstone kunna lösa "There is already an ongoing simulation", "Set user's password", etc)

X Varning om @start_trial vs @omit

X Add "Preview" to preview in "My Files"

X Redis Queue + Progress bar
  - Cancel button: https://stackoverflow.com/questions/18511119/stop-processing-flask-route-if-request-aborted
  - Store progress info in db. Inherit Progress object.
  - Pull regularly from client
  Cancel button: Maybe use https://stackoverflow.com/questions/18511119/stop-processing-flask-route-if-request-aborted

X "You sure you want to delete script ...?"

X "Save & run"

X "Keep current figures" checkbox (If an error occurs, dont delete current figs if this is checked)

X "Restore (factory) defaults", at least for "Paper" and "Plot background"

X Selection png/jpeg/webp/svg for download plotly-plot (with camera-icon)
X https://plotly.com/javascript/configuration-options/#customize-download-plot-options
X https://plotly.com/javascript/static-image-export/: "The common image formats: 'PNG', 'JPG/JPEG' are supported. In addition, formats like 'EPS', 'SVG' and 'PDF' are also available for user with a Personal or Professional subscription."

X Change default filename for exported plotly plots from "figfile..." (newplot)
X to "learning_simulator..." e.dyl.

X Remove default legend pos. (bec. it doesn't work for scripts without @legend,
X and toggling legend with the "Toggle legend" button)

X Buttons for toggle x-grid, y-grid, toggle legend only for plotly plots, not mpl.

X Fix visbility of controls in settings based on plotly/mpl-selection.

X When vector format is chosen, change "image size" to "plot size".

X Toggle x-grid and y-grid only takes first subplot

X Merge in master

X Use "editable mode": https://plotly.com/javascript/configuration-options/ 
  for Plot parameters: Plot title, xlim, ylim, xlabel, ylabel

X Make "control panel" for plots:
X     Plot parameters: Grid on/off toggle button
X     Plot parameters: Legend on/off toggle button
X using https://plotly.com/javascript/custom-buttons/ ?




============
Maybe later
============
Move "Default legend position", "Default colors", "Default plot size" to "My Preferences"?

"Plot as" switch buttons instead of drop-down

Log-window?

Inspiration:
https://plotly.com/javascript/configuration-options/ - especially "editable mode"

Make "Name of script" read-only but with an "Edit" button that makes it editable and shows "Save" and "Cancel"

Plots: Responsive layout for plots: https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_two_columns_responsive
(Needed?)

Plot: Range sliders?

For Mpl-figures: 
Add "Image size and dpi can be set using
    @figure ... {'figsize', [inches_x, inches_y], 'dpi', dpi}
Add "Note: Can be overwritten by @figure ... { figsize: [width, height] }"


=========================================================
Maybe make issue (later):
=========================================================
Plot parameters: paper color (paper_bgcolor), plot background color (plot_bgcolor)
Plot parameters: Legend on/off, legend positioning
Plot parameters: line color, thickness, marker, marker size, color, etc.

Investigate if use_pyplot=False can be used in Tk frontend. (See issue about crashes.)

Multiple @exports with the same filename gives several "icons" in the plot area pointing to the same file.
That should create only one "icon".

Delete @export-files and @plot-image-files when figure / "export-icon" is
deleted (either Close All Figures or delete/close-icon).
Not (only) at reload simulation page.

Issue warning (somehow) if unsupported mpl-props for lines are used in plotly plot,
saying "can be changed using advanced settings" or something like that.
Only "color", "linewidth", "marker" and "markersize" (and "label") are supported.

Protect the entire admin endpoint, not only its sub-pages
